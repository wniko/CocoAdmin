(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6a86decc"],{1989:function(e,t,i){},"333d":function(e,t,i){"use strict";var c=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[i("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},n=[];i("a9e3");Math.easeInOutQuad=function(e,t,i,c){return e/=c/2,e<1?i/2*e*e+t:(e--,-i/2*(e*(e-2)-1)+t)};var a=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function o(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function s(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function l(e,t,i){var c=s(),n=e-c,l=20,r=0;t="undefined"===typeof t?500:t;var d=function e(){r+=l;var s=Math.easeInOutQuad(r,c,n,t);o(s),r<t?a(e):i&&"function"===typeof i&&i()};d()}var r={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&l(0,800)},handleCurrentChange:function(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&l(0,800)}}},d=r,u=(i("d887"),i("2877")),v=Object(u["a"])(d,c,n,!1,null,"0b2719bc",null);t["a"]=v.exports},"3bbd":function(e,t,i){},"72d1":function(e,t,i){"use strict";i.d(t,"h",(function(){return n})),i.d(t,"l",(function(){return a})),i.d(t,"k",(function(){return o})),i.d(t,"b",(function(){return s})),i.d(t,"j",(function(){return l})),i.d(t,"i",(function(){return r})),i.d(t,"r",(function(){return d})),i.d(t,"n",(function(){return u})),i.d(t,"p",(function(){return v})),i.d(t,"o",(function(){return p})),i.d(t,"q",(function(){return m})),i.d(t,"m",(function(){return h})),i.d(t,"a",(function(){return f})),i.d(t,"e",(function(){return g})),i.d(t,"d",(function(){return b})),i.d(t,"f",(function(){return y})),i.d(t,"c",(function(){return S})),i.d(t,"g",(function(){return L}));var c=i("b775");function n(e){return Object(c["a"])({url:"/coco/device/status",method:"post",data:e})}function a(e){return Object(c["a"])({url:"/coco/package/order/user/order/list",method:"post",data:e})}function o(e){return Object(c["a"])({url:"/coco/package/order/detail",method:"get",params:e})}function s(e){return Object(c["a"])({url:"/coco/package/order/user/order/query",method:"post",data:e})}function l(e){return Object(c["a"])({url:"/coco/core/device/snapshot",method:"post",data:e})}function r(e){return Object(c["a"])({url:"/coco/core/device/remote",method:"post",data:e})}function d(e){return Object(c["a"])({url:"/coco/core/device/restart",method:"post",data:e})}function u(e){return Object(c["a"])({url:"/coco/core/device/gohome",method:"post",data:e})}function v(e){return Object(c["a"])({url:"/coco/core/device/ipswitch",method:"post",data:e})}function p(e){return Object(c["a"])({url:"/coco/core/device/ipproxyclose",method:"post",data:e})}function m(e){return Object(c["a"])({url:"/coco/core/device/reset",method:"post",data:e})}function h(e){return Object(c["a"])({url:"/coco/core/device/batch/newphone",method:"post",data:e})}function f(e){return Object(c["a"])({url:"/coco/device/group/set",method:"post",data:e})}function g(e){return Object(c["a"])({url:"/coco/core/device/virtual/camera",method:"post",data:e})}function b(e){return Object(c["a"])({url:"/coco/core/device/replace",method:"post",data:e})}function y(e){return Object(c["a"])({url:"/coco/core/ip/areas",method:"post",data:e})}function S(e){return Object(c["a"])({url:"/coco/device/remarks/set",method:"post",data:e})}function L(e){return Object(c["a"])({url:"/coco/core/batch/snap/shot",method:"post",data:e})}},7801:function(e,t,i){"use strict";i.r(t);var c=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-select",{staticClass:"filter-item",staticStyle:{width:"120px"},attrs:{placeholder:"到期时间",clearable:"",size:"small"},on:{change:e.handleDeviceListFilter},model:{value:e.deviceListQuery.expireDays,callback:function(t){e.$set(e.deviceListQuery,"expireDays",t)},expression:"deviceListQuery.expireDays"}},e._l(e.daysDeviceListQueryOptions,(function(e){return i("el-option",{key:e.days,attrs:{label:e.option,value:e.days,size:"small"}})})),1),i("el-select",{staticClass:"filter-item",staticStyle:{width:"100px"},attrs:{placeholder:"分发状态",clearable:"",size:"small"},on:{change:e.handleDeviceListFilter},model:{value:e.deviceListQuery.status,callback:function(t){e.$set(e.deviceListQuery,"status",t)},expression:"deviceListQuery.status"}},e._l(e.allocationStatusList,(function(e){return i("el-option",{key:e.id,attrs:{label:e.status,value:e.id}})})),1),i("el-select",{staticClass:"filter-item",staticStyle:{width:"100px"},attrs:{placeholder:"云机站点",clearable:"",size:"small"},on:{change:e.handleDeviceListFilter},model:{value:e.deviceListQuery.site,callback:function(t){e.$set(e.deviceListQuery,"site",t)},expression:"deviceListQuery.site"}},e._l(e.siteOptions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),i("el-select",{staticClass:"filter-item",staticStyle:{width:"100px"},attrs:{placeholder:"云机版本",clearable:"",size:"small"},on:{change:e.handleDeviceListFilter},model:{value:e.deviceListQuery.version,callback:function(t){e.$set(e.deviceListQuery,"version",t)},expression:"deviceListQuery.version"}},e._l(e.deviceVersionInfoList.filter((function(e){return 1===e.productDays})),(function(e){return i("el-option",{key:e.deviceVersionId,attrs:{label:e.deviceVersionName,value:e.deviceVersionId}})})),1),i("el-select",{staticClass:"filter-item",staticStyle:{width:"100px"},attrs:{placeholder:"云机状态",clearable:"",size:"small"},on:{change:e.handleDeviceListFilter},model:{value:e.deviceListQuery.deviceStatus,callback:function(t){e.$set(e.deviceListQuery,"deviceStatus",t)},expression:"deviceListQuery.deviceStatus"}},e._l(e.statusDeviceListQueryOptions,(function(e){return i("el-option",{key:e.status,attrs:{label:e.option,value:e.status,size:"small"}})})),1),i("el-select",{staticClass:"filter-item",staticStyle:{width:"100px"},attrs:{placeholder:"容器分机",clearable:"",size:"small"},on:{change:e.handleDeviceListFilter},model:{value:e.deviceListQuery.hideSlave,callback:function(t){e.$set(e.deviceListQuery,"hideSlave",t)},expression:"deviceListQuery.hideSlave"}},[i("el-option",{attrs:{label:"不隐藏",value:0}}),i("el-option",{attrs:{label:"隐藏",value:1}})],1),i("el-select",{staticClass:"filter-item",staticStyle:{width:"180px"},attrs:{placeholder:"配套服务",clearable:"",size:"small"},on:{change:e.handleDeviceListFilter},model:{value:e.deviceListQuery.service,callback:function(t){e.$set(e.deviceListQuery,"service",t)},expression:"deviceListQuery.service"}},e._l(e.currentBusinessServicePackageList,(function(t){return 30===t.productDays?i("el-option",{key:t.businessServiceId,attrs:{label:t.businessServiceName,value:t.businessServiceId}}):e._e()})),1),i("br"),i("el-autocomplete",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{"popper-class":"user-autocomplete","fetch-suggestions":e.queryUserSearch,clearable:"","value-key":"userPhone",placeholder:"用户手机号",size:"small"},on:{select:e.handleDeviceListFilter},scopedSlots:e._u([{key:"default",fn:function(t){var c=t.item;return[i("div",{staticClass:"phone"},[e._v(e._s(c.userPhone))]),i("span",{staticClass:"nick"},[e._v(e._s(c.userNick))])]}}]),model:{value:e.deviceListQuery.phoneNum,callback:function(t){e.$set(e.deviceListQuery,"phoneNum",t)},expression:"deviceListQuery.phoneNum"}}),i("el-input",{staticClass:"filter-item",staticStyle:{width:"100px"},attrs:{placeholder:"云机ID",clearable:"",size:"small"},on:{clear:e.handleDeviceListFilter},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleDeviceListFilter(t)}},model:{value:e.deviceListQuery.deviceId,callback:function(t){e.$set(e.deviceListQuery,"deviceId",t)},expression:"deviceListQuery.deviceId"}}),i("el-input",{staticClass:"filter-item",staticStyle:{width:"100px"},attrs:{placeholder:"河马云ID",clearable:"",size:"small"},on:{clear:e.handleDeviceListFilter},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleDeviceListFilter(t)}},model:{value:e.deviceListQuery.hippoId,callback:function(t){e.$set(e.deviceListQuery,"hippoId",t)},expression:"deviceListQuery.hippoId"}}),i("el-input",{staticClass:"filter-item",staticStyle:{width:"100px"},attrs:{placeholder:"UUID",clearable:"",size:"small"},on:{clear:e.handleDeviceListFilter},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleDeviceListFilter(t)}},model:{value:e.deviceListQuery.uuid,callback:function(t){e.$set(e.deviceListQuery,"uuid",t)},expression:"deviceListQuery.uuid"}}),i("el-button",{staticClass:"filter-item",attrs:{size:"small"},on:{click:e.handleDeviceListFilter}},[e._v(" 搜索 ")]),i("el-button",{staticClass:"filter-item",attrs:{size:"small",type:"primary"},on:{click:e.deviceAllocClick}},[i("i",{staticClass:"el-icon-s-promotion"}),e._v(" 批量发放/加时 ")]),i("el-button",{staticClass:"filter-item",attrs:{size:"small",type:"primary"},on:{click:e.deviceRecycleClick}},[e._v(" 批量回收 ")])],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.deviceListLoading,expression:"deviceListLoading"}],ref:"deviceList",staticStyle:{"max-width":"1580px"},attrs:{data:e.deviceList,border:"","highlight-current-row":"",size:"small"},on:{"selection-change":e.handleDeviceListSelectionChange,"sort-change":e.handleDeviceListSortChange}},[i("el-table-column",{attrs:{fixed:"",type:"selection",width:"45",selectable:e.deviceListSelectEnable}}),i("el-table-column",{attrs:{label:"云机ID",prop:"id",width:"65",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var c=t.row;return[c.deviceMasterCocoId>0?i("span",[e._v(e._s(c.deviceMasterCocoId))]):i("span",[e._v(e._s(c.deviceId))])]}}])}),i("el-table-column",{attrs:{label:"河马云ID",width:"85",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var c=t.row;return[i("span",[e._v(e._s(c.siteId)+"#"+e._s(c.hippoCloudDeviceId))])]}}])}),i("el-table-column",{attrs:{label:"UUID",width:"125",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var c=t.row;return[i("span",[e._v(e._s(c.uuid))])]}}])}),i("el-table-column",{attrs:{label:"云机版本",width:"140",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var c=t.row;return[c.deviceMaster>0?i("span",[e._v(e._s(c.deviceVersionName+" - 分机"))]):-1===c.deviceMaster?i("span",[e._v(e._s(c.deviceVersionName+" - 主机"))]):i("span",[e._v(e._s(c.deviceVersionName))])]}}])}),i("el-table-column",{attrs:{label:"到期时间",width:"160",align:"center",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){var c=t.row;return[i("span",[e._v(e._s(c.expireTime))])]}}])}),i("el-table-column",{attrs:{label:"配套服务",align:"center"}},[i("el-table-column",{attrs:{label:"内容",width:"160",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var c=t.row;return[e._l(c.businessStatusList,(function(t){return[i("p",[e._v(e._s(t.businessServiceName))])]}))]}}])}),i("el-table-column",{attrs:{label:"到期时间",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var c=t.row;return[e._l(c.businessStatusList,(function(t){return[i("p",[e._v(e._s(t.businessExpireTime))])]}))]}}])})],1),i("el-table-column",{attrs:{label:"云机状态",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var c=t.row;return[i("span",[e._v(e._s(e._f("deviceStatusMapping")(c.deviceStatus)))])]}}])}),i("el-table-column",{attrs:{label:"用户手机号",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var c=t.row;return[i("span",[e._v(e._s(c.userPhone))])]}}])}),i("el-table-column",{attrs:{label:"用户到期时间","min-width":"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var c=t.row;return[i("span",[e._v(e._s(c.allocationExpireTime))])]}}])}),i("el-table-column",{attrs:{label:"管理",width:"175",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var c=t.row;return[c.deviceMaster<=0?[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.deviceReplaceClick(c)}}},[e._v(" 故障更换 ")]),i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return e.deviceAllocClick(c)}}},[e._v(" "+e._s(1===c.allocationStatus?"加时":"发放")+" ")]),i("el-button",{attrs:{type:"text",size:"mini",disabled:1!==c.allocationStatus},on:{click:function(t){return e.deviceRecycleClick(c)}}},[e._v(" 回收 ")])]:[i("span",[e._v("跟随主机的管理")])]]}}])})],1),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.deviceListTotal>0,expression:"deviceListTotal > 0"}],attrs:{total:e.deviceListTotal,page:e.deviceListQuery.page,limit:e.deviceListQuery.pageSize},on:{"update:page":function(t){return e.$set(e.deviceListQuery,"page",t)},"update:limit":function(t){return e.$set(e.deviceListQuery,"pageSize",t)},pagination:e.getDeviceList}}),i("el-dialog",{staticClass:"alloc-dialog",attrs:{visible:e.deviceRecycleDialogVisible,"close-on-click-modal":!1,title:"回收云机",width:"350px"},on:{"update:visible":function(t){e.deviceRecycleDialogVisible=t}}},[e.deviceRecycleData.id?[i("p",[e._v("云机ID："+e._s(e.deviceRecycleData.id))]),i("p",[e._v("所属用户："+e._s(e.deviceRecycleData.phoneNum))]),i("p",[e._v("到期时间："+e._s(e.deviceRecycleData.expireTime))])]:[i("p",[e._v("云机ID："+e._s(e.deviceRecycleData.ids.join(", ")))]),i("p",[e._v("回收数量："+e._s(e.deviceRecycleData.ids.length))])],i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.deviceRecycleSubmitConfirm}},[e._v(e._s(e.deviceRecycleSubmitLoding?"回收中":"确定回收"))])],1)],2),i("el-dialog",{staticClass:"alloc-dialog",attrs:{visible:e.deviceAllocDialogVisible,title:"发放云机",width:"350px","close-on-click-modal":!1},on:{"update:visible":function(t){e.deviceAllocDialogVisible=t},close:e.handleDeviceAllocDialogClose}},[i("el-form",{ref:"deviceAllocForm",attrs:{model:e.deviceAllocForm,rules:e.deviceAllocFormRules,"label-width":"90px",size:"mini"}},[i("el-form-item",{attrs:{label:"已选云机数"}},[i("span",[e._v(e._s(this.deviceAllocForm.ids.length))])]),i("el-form-item",{attrs:{label:"指定用户",prop:"phoneNum"}},[i("el-autocomplete",{staticStyle:{width:"100%"},attrs:{"popper-class":"user-autocomplete","fetch-suggestions":e.queryUserSearch,placeholder:"请输入用户手机号"},on:{select:e.handleUserSelect},scopedSlots:e._u([{key:"default",fn:function(t){var c=t.item;return[i("div",{staticClass:"phone"},[e._v(e._s(c.userPhone))]),i("span",{staticClass:"nick"},[e._v(e._s(c.userNick))])]}}]),model:{value:e.deviceAllocForm.phoneNum,callback:function(t){e.$set(e.deviceAllocForm,"phoneNum",t)},expression:"deviceAllocForm.phoneNum"}})],1),i("el-form-item",{attrs:{label:"发放时间"}},[i("el-radio-group",{model:{value:e.deviceAllocForm.hmExpireTime,callback:function(t){e.$set(e.deviceAllocForm,"hmExpireTime",t)},expression:"deviceAllocForm.hmExpireTime"}},[i("el-radio",{attrs:{label:!0}},[e._v("河马云到期时间")]),i("el-radio",{attrs:{label:!1}},[e._v("自定义")])],1)],1),e.deviceAllocForm.hmExpireTime?e._e():i("el-form-item",{attrs:{label:"到期时间"}},[i("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime","picker-options":e.pickerOptions,"value-format":"timestamp",format:"yyyy-MM-dd HH:mm",placeholder:"选择到期时间",size:"small"},on:{change:e.handleUserDateChange},model:{value:e.deviceAllocForm.expireTime,callback:function(t){e.$set(e.deviceAllocForm,"expireTime",t)},expression:"deviceAllocForm.expireTime"}},[i("template",{slot:"append"},[e._v("天")])],2)],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.deviceAllocSubmit}},[e._v(e._s(e.deviceAllocSubmitLoding?"发放中":"确定发放"))])],1)],1),i("el-dialog",{attrs:{visible:e.deviceNameSettingDialogVisible,"close-on-click-modal":!1,title:"云机名称设置",width:"380px"},on:{"update:visible":function(t){e.deviceNameSettingDialogVisible=t}}},[i("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入名称",maxlength:"3","show-word-limit":""},model:{value:e.deviceNameSetting,callback:function(t){e.deviceNameSetting=t},expression:"deviceNameSetting"}},[i("el-select",{attrs:{slot:"prepend",placeholder:"请选择"},on:{change:e.handleDeviceNameIdSelectChange},slot:"prepend",model:{value:e.deviceNameIdSelect,callback:function(t){e.deviceNameIdSelect=t},expression:"deviceNameIdSelect"}},[e._l(e.deviceNameList,(function(e){return[i("el-option",{attrs:{label:e.hippoDeviceVersionName,value:e.id}})]}))],2)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.deviceNameSetingSubmitLoding,expression:"deviceNameSetingSubmitLoding"}],attrs:{type:"primary",size:"mini"},on:{click:e.deviceNameSettingSubmit}},[e._v(e._s(e.deviceNameSetingSubmitLoding?"修改中":"确定"))])],1)],1)],1)},n=[],a=(i("99af"),i("4de4"),i("7db0"),i("4160"),i("c975"),i("13d5"),i("fb6a"),i("ac1f"),i("1276"),i("159b"),i("bf19"),i("2909")),o=i("5530"),s=i("2f62"),l=i("333d"),r=i("aa98"),d=i("c24f"),u=(i("f8b7"),i("e285")),v=i("72d1"),p=function(e){var t=new Date(e),i=t.getFullYear(),c="0"+(t.getMonth()+1),n="0"+t.getDate(),a="0"+t.getHours(),o="0"+t.getMinutes(),s="0"+t.getSeconds();return i+"-"+c.substr(-2)+"-"+n.substr(-2)+" "+a.substr(-2)+":"+o.substr(-2)+":"+s.substr(-2)},m=[{days:1,option:"今日到期"},{days:3,option:"3天内到期"},{days:7,option:"7天内到期"},{days:-1,option:"全部"}],h=[{status:0,option:"正常"},{status:1,option:"重启中"},{status:3,option:"故障"},{status:-1,option:"全部"}],f=function(e){return e.toJSON().slice(0,10)+" 00:00:00"},g=function(e){var t=new Date;return new Date(t.getTime()+24*e*60*60*1e3)},b={name:"DeviceList",components:{Pagination:l["a"]},data:function(){var e=[{id:1,status:"已发放"},{id:2,status:"未发放"}],t={phoneNum:[{required:!0,pattern:/^1\d{10}$/,message:"请输入正确的手机号",trigger:"change"}]},i={disabledDate:function(e){return e.getTime()+864e5<Date.now()},shortcuts:[{text:"一天",onClick:function(e){var t=new Date;t.setTime(t.getTime()+864e5),e.$emit("pick",t)}},{text:"一周",onClick:function(e){var t=new Date;t.setTime(t.getTime()+6048e5),e.$emit("pick",t)}},{text:"一个月",onClick:function(e){var t=new Date;t.setTime(t.getTime()+2592e6),e.$emit("pick",t)}}]},c=[{value:0,label:"全部站点"},{value:1,label:"华东一站"},{value:2,label:"华东二站"}];return{daysDeviceListQueryOptions:m,statusDeviceListQueryOptions:h,siteOptions:c,allocationStatusList:e,state:"",deviceListQuery:{expireDays:void 0,site:void 0,page:1,pageSize:20,status:void 0,deviceStatus:void 0,version:void 0,service:void 0,hideSlave:void 0,phoneNum:void 0,deviceId:void 0,hippoId:void 0,uuid:void 0,expireOrder:void 0},deviceListTotal:0,deviceList:[],deviceListLoading:!1,deviceAllocDialogVisible:!1,deviceAllocForm:{ids:[],phoneNum:"",hmExpireTime:!0,expireTime:void 0,days:void 0},deviceAllocFormRules:t,deviceAllocSubmitLoding:!1,deviceRecycleDialogVisible:!1,deviceRecycleData:{ids:[],id:void 0,phoneNum:void 0,expireTime:void 0},deviceRecycleSubmitLoding:!1,userList:[],pickerOptions:i,deviceNameSettingDialogVisible:!1,deviceNameSetting:"",deviceNameIdSelect:void 0,deviceNameList:[],deviceNameSetingSubmitLoding:!1}},computed:Object(o["a"])({},Object(s["b"])(["token","deviceVersionInfoList","businessServicePackageList"]),{currentBusinessServicePackageList:function(){return this.businessServicePackageList.reduce((function(e,t){return 1===t.nodeType?[].concat(Object(a["a"])(e),Object(a["a"])(t.dicBusinessServicePriceList)):[].concat(Object(a["a"])(e),[t])}),[]).filter((function(e){return 5!==e.businessServiceId}))}}),filters:{deviceStatusMapping:function(e){switch(e){case 0:return"正常";case 1:return"重启中";case 2:return"软件安装中";case 3:return"故障";case 10:return"回收中"}return"未知"}},created:function(){this.$store.dispatch("order/getInfo"),this.getOrderInfo(),this.getDeviceList(),this.getUserList()},methods:{getOrderInfo:function(){},getUserList:function(){var e=this,t=this.token;Object(d["c"])({token:t,page:1,pageSize:1e4}).then((function(t){var i=t.list;e.userList=i})).catch((function(e){}))},getDeviceList:function(){var e=this,t=this.deviceListQuery,i=t.expireDays,c=t.site,n=t.page,a=t.pageSize,o=t.status,s=t.version,l=t.service,d=t.hideSlave,u=t.phoneNum,v=t.deviceId,p=t.uuid,m=t.hippoId,h=t.deviceStatus,b=t.expireOrder,y={page:n,pageSize:a};if(o&&(y.allocationStatus=o),s&&(y.deviceVersionId=s),l&&(y.businessServiceId=l),u&&(y.userPhone=u),v&&(y.deviceId=v),p&&(y.uuid=p),m){var S=m.split("#");y.hippoId=S.length>1?S[1]:S[0]}c&&(y.siteId=c),b&&(y.expireOrder=b),d&&(y.hideSlave=d),y.deviceStatus=h||-1,i&&i>-1&&(y.expireBeginTime=f(new Date),y.expireEndTime=f(g(i))),this.deviceListLoading=!0,Object(r["f"])(y).then((function(t){var i=t.list,c=t.total;e.deviceList=i,e.deviceListTotal=c,e.deviceListLoading=!1})).catch((function(t){e.deviceListLoading=!1}))},handleDeviceListFilter:function(){this.deviceListQuery.page=1,this.getDeviceList()},sortDeviceList:function(e){return e.sort((function(e,t){return e.deviceId-t.deviceId})).reduce((function(t,i){if(i.deviceMaster>0)return t;if(-1===i.deviceMaster){var c=e.find((function(e){return e.deviceMaster===i.hippoCloudDeviceId}));return[].concat(Object(a["a"])(t),c?[i,c]:[i])}return[].concat(Object(a["a"])(t),[i])}),[])},getDeviceId:function(e){var t;return null===(t=this.deviceList.find((function(t){return t.hippoCloudDeviceId===e})))||void 0===t?void 0:t.deviceId},deviceRestartClick:function(e){var t=this;Object(v["r"])({token:this.token,deviceIdList:[e.deviceId]}).then((function(){t.$message.success("重启命令已发送")}))},deviceReplaceClick:function(e){var t=this;this.$confirm("此操作是将出现故障的设备更换新的设备, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(v["d"])({deviceId:e.deviceId}).then((function(e){t.$message({type:"success",message:"更换成功!"})}))}))},deviceAllocClick:function(e){e&&e.deviceId&&(this.deviceAllocForm.ids=[e.deviceId],e.userPhone&&(this.deviceAllocForm.phoneNum=e.userPhone)),this.deviceAllocForm.ids.length>0?this.deviceAllocDialogVisible=!0:this.$message.warning("请先选择云机")},deviceRecycleClick:function(e){return e&&e.deviceId?(this.deviceRecycleData.ids=[],this.deviceRecycleData.id=e.deviceId,this.deviceRecycleData.phoneNum=e.userPhone,this.deviceRecycleData.expireTime=e.allocationExpireTime,void(this.deviceRecycleDialogVisible=!0)):this.deviceAllocForm.ids.length>0?(this.deviceRecycleData.ids=Object(a["a"])(this.deviceAllocForm.ids),this.deviceRecycleData.id=void 0,void(this.deviceRecycleDialogVisible=!0)):void this.$message.warning("请先选择云机")},handleDeviceListSelectionChange:function(e){var t=this;this.deviceAllocForm.ids=[],e.forEach((function(e){t.deviceAllocForm.ids.push(e.deviceId)}))},handleDeviceListSortChange:function(e){var t=e.column,i=e.order;"到期时间"===t.label&&(this.deviceListQuery.expireOrder="ascending"===i?1:"descending"===i?2:void 0,this.getDeviceList())},handleDeviceListRowClick:function(e){1!==e.allocationStatus&&this.$refs["deviceList"].toggleRowSelection(e)},deviceAllocSubmit:function(){var e=this;this.$refs["deviceAllocForm"].validate((function(t){if(t){var i=e.deviceAllocForm,c=i.ids,n=i.phoneNum,a=i.days,o=i.expireTime,s=i.hmExpireTime;return s||o?(e.deviceAllocSubmitLoding=!0,s?Object(r["d"])({token:e.token,deviceIdList:c,userPhone:n}).then((function(t){e.$message.success("发放成功"),e.deviceAllocSubmitLoding=!1,e.deviceAllocDialogVisible=!1,e.getDeviceList()})).catch((function(t){e.deviceAllocSubmitLoding=!1,e.deviceAllocDialogVisible=!1})):Object(r["a"])({token:e.token,deviceIdList:c,userPhone:n,expireTime:p(o),days:a}).then((function(t){e.$message.success("发放成功"),e.deviceAllocSubmitLoding=!1,e.deviceAllocDialogVisible=!1,e.getDeviceList()})).catch((function(t){e.deviceAllocSubmitLoding=!1,e.deviceAllocDialogVisible=!1})),!0):(message.warning("请选择到期时间"),!1)}return!1}))},deviceRecycleSubmitConfirm:function(){var e=this;this.$confirm("回收后云机将恢复出厂设置，应用及数据不可恢复，是否确认回收?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.deviceRecycleSubmit()})).catch((function(){}))},deviceRecycleSubmit:function(){var e=this;this.deviceRecycleSubmitLoding=!0;var t=this.deviceRecycleData,i=t.id,c=t.ids;Object(r["c"])({token:this.token,deviceIdList:i?[i]:c}).then((function(t){e.$message.success("回收成功"),e.deviceRecycleSubmitLoding=!1,e.deviceRecycleDialogVisible=!1,e.getDeviceList()})).catch((function(t){e.deviceRecycleSubmitLoding=!1,e.deviceRecycleDialogVisible=!1}))},handleDeviceAllocDialogClose:function(){this.deviceAllocForm={ids:[],phoneNum:"",hmExpireTime:!0,expireTime:void 0,days:void 0},this.$refs["deviceList"].clearSelection()},queryUserSearch:function(e,t){var i=this.userList,c=e?i.filter(this.createUserFilter(e)):i;t(c)},createUserFilter:function(e){return function(t){return 0===t.userPhone.toLowerCase().indexOf(e.toLowerCase())}},handleUserSelect:function(e){this.deviceAllocForm.phoneNum=e.userPhone},deviceListSelectEnable:function(e,t){return!(e.deviceMaster>0)},handleUserDateChange:function(){var e=this.deviceAllocForm.expireTime,t=this.deviceAllocForm.days,i=Math.ceil((e-Date.now())/864e5);if(i<1)return this.$message.warning("到期时间不能低于当前时间"),void(this.deviceAllocForm.expireTime=void 0);i!==t&&(this.deviceAllocForm.days=i)},handleUserDaysChange:function(){var e=this.deviceAllocForm.expireTime,t=this.deviceAllocForm.days,i=Math.ceil((e-Date.now())/864e5);i!==t&&(this.deviceAllocForm.expireTime=Date.now()+864e5*t)},handleDeviceNameSetting:function(){this.deviceNameSettingDialogVisible=!0,this.getDeviceNameList()},getDeviceNameList:function(){var e=this;Object(u["e"])().then((function(t){return e.deviceNameList=t.data})).catch((function(){return e.deviceNameSettingDialogVisible=!1}))},handleDeviceNameIdSelectChange:function(e){this.deviceNameSetting=this.deviceNameList.find((function(t){return t.id===e})).deviceVersionName},deviceNameSettingSubmit:function(){var e=this;this.deviceNameIdSelect?(this.deviceNameSetingSubmitLoding=!0,Object(u["d"])({id:this.deviceNameIdSelect,deviceVersionName:this.deviceNameSetting}).then((function(t){e.$message.success("修改成功！"),e.deviceNameSetingSubmitLoding=!1})).catch((function(){e.deviceNameSetingSubmitLoding=!1}))):this.$message.warning("请选择一个版本名称！")}}},y=b,S=(i("fbea"),i("9166"),i("2877")),L=Object(S["a"])(y,c,n,!1,null,"b2972766",null);t["default"]=L.exports},9166:function(e,t,i){"use strict";var c=i("3bbd"),n=i.n(c);n.a},aa98:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"d",(function(){return a})),i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return s})),i.d(t,"e",(function(){return l})),i.d(t,"f",(function(){return r})),i.d(t,"g",(function(){return d}));var c=i("b775");function n(e){return Object(c["a"])({url:"/coco/device/allocation",method:"post",data:e})}function a(e){return Object(c["a"])({url:"/coco/device/allocation/syn",method:"post",data:e})}function o(e){return Object(c["a"])({url:"/coco/device/allocation/record",method:"post",data:e})}function s(e){return Object(c["a"])({url:"/coco/device/allocation/recycle",method:"post",data:e})}function l(e){return Object(c["a"])({url:"/coco/device/allocation/record/list",method:"post",data:e})}function r(e){return Object(c["a"])({url:"/coco/device/manager/list",method:"post",data:e})}function d(e){return Object(c["a"])({url:"/coco/device/renew/list",method:"post",data:e})}},d887:function(e,t,i){"use strict";var c=i("1989"),n=i.n(c);n.a},dc8d:function(e,t,i){},fbea:function(e,t,i){"use strict";var c=i("dc8d"),n=i.n(c);n.a}}]);