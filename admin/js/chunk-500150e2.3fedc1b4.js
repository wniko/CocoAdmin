(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-500150e2"],{1989:function(e,t,r){},"333d":function(e,t,r){"use strict";var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"pagination-container",class:{hidden:e.hidden}},[r("el-pagination",e._b({attrs:{background:e.background,"current-page":e.currentPage,"page-size":e.pageSize,layout:e.layout,"page-sizes":e.pageSizes,total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},"el-pagination",e.$attrs,!1))],1)},n=[];r("a9e3");Math.easeInOutQuad=function(e,t,r,i){return e/=i/2,e<1?r/2*e*e+t:(e--,-r/2*(e*(e-2)-1)+t)};var s=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function o(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function a(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function l(e,t,r){var i=a(),n=e-i,l=20,c=0;t="undefined"===typeof t?500:t;var u=function e(){c+=l;var a=Math.easeInOutQuad(c,i,n,t);o(a),c<t?s(e):r&&"function"===typeof r&&r()};u()}var c={name:"Pagination",props:{total:{required:!0,type:Number},page:{type:Number,default:1},limit:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,20,30,50]}},layout:{type:String,default:"total, sizes, prev, pager, next, jumper"},background:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0},hidden:{type:Boolean,default:!1}},computed:{currentPage:{get:function(){return this.page},set:function(e){this.$emit("update:page",e)}},pageSize:{get:function(){return this.limit},set:function(e){this.$emit("update:limit",e)}}},methods:{handleSizeChange:function(e){this.$emit("pagination",{page:this.currentPage,limit:e}),this.autoScroll&&l(0,800)},handleCurrentChange:function(e){this.$emit("pagination",{page:e,limit:this.pageSize}),this.autoScroll&&l(0,800)}}},u=c,d=(r("d887"),r("2877")),p=Object(d["a"])(u,i,n,!1,null,"0b2719bc",null);t["a"]=p.exports},"4d44":function(e,t,r){"use strict";r.d(t,"d",(function(){return n})),r.d(t,"e",(function(){return s})),r.d(t,"c",(function(){return o})),r.d(t,"f",(function(){return a})),r.d(t,"b",(function(){return l})),r.d(t,"a",(function(){return c}));var i=r("b775");function n(e){return Object(i["a"])({url:"/coco/business/individual/manager/list",method:"post",data:e})}function s(e){return Object(i["a"])({url:"/coco/user/summary/list",method:"post",data:e})}function o(){return Object(i["a"])({url:"/coco/staff/operation/reason/list",method:"get"})}function a(e){return Object(i["a"])({url:"/coco/staff/operation/generate/code",method:"post",data:e})}function l(){return Object(i["a"])({url:"/coco/staff/operation/list",method:"get"})}function c(e){return Object(i["a"])({url:"/coco/staff/operation/delete/token",method:"get",params:e})}},"57ce":function(e,t,r){},"8d9f":function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-dialog",{attrs:{visible:e.orderDialogVisible,"close-on-click-modal":!1,title:"预定云机",width:"450px"},on:{"update:visible":function(t){e.orderDialogVisible=t}}},[r("el-form",{ref:"orderForm",attrs:{model:e.orderForm,"label-width":"80px",size:"small"}},[r("el-form-item",{attrs:{label:"选择站点"}},[r("el-select",{on:{change:e.siteSelectChange},model:{value:e.orderForm.siteId,callback:function(t){e.$set(e.orderForm,"siteId",t)},expression:"orderForm.siteId"}},[r("el-option",{attrs:{value:1,label:"华东一站"}}),r("el-option",{attrs:{value:2,label:"华东二站"}})],1)],1),r("el-form-item",{attrs:{label:"云机版本",prop:"version"}},[r("el-select",{attrs:{placeholder:"请选择版本"},on:{change:e.updateOrderDaysOptions},model:{value:e.orderForm.version,callback:function(t){e.$set(e.orderForm,"version",t)},expression:"orderForm.version"}},e._l(e.orderDeviceVersionOptions,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),r("el-form-item",{attrs:{label:"预定时长"}},[r("el-radio-group",{model:{value:e.orderForm.days,callback:function(t){e.$set(e.orderForm,"days",t)},expression:"orderForm.days"}},e._l(e.orderDaysOptions,(function(t){return r("el-radio-button",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1),r("el-form-item",{attrs:{label:"预定数量"}},[r("el-input-number",{attrs:{"controls-position":"right",min:1,max:100,step:1,"step-strictly":""},model:{value:e.orderForm.num,callback:function(t){e.$set(e.orderForm,"num",t)},expression:"orderForm.num"}}),r("el-tooltip",{attrs:{placement:"right"}},[r("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 单次预定上限100台，可分多次预定（单用户预定上限500台） ")]),r("i",{staticClass:"el-icon-question",staticStyle:{"font-size":"16px","margin-left":"5px",cursor:"pointer"}})])],1),r("el-form-item",{attrs:{label:"配套服务"}},[r("el-select",{attrs:{placeholder:"选择配套服务(可多选)",multiple:""},on:{change:e.servicesChange},model:{value:e.orderForm.services,callback:function(t){e.$set(e.orderForm,"services",t)},expression:"orderForm.services"}},e._l(e.getServicesOptions(e.orderForm.days,e.isMasterDeviceVersion(e.orderForm.version)),(function(t){return r("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.children,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value,disabled:e.disabled}})})),1)})),1),r("el-tooltip",{attrs:{placement:"right"}},[r("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 时长和价格，与云机预定时长相对应 "),r("br"),e._v(" 容器云机的配套服务，会同时购买两份 ")]),r("i",{staticClass:"el-icon-question",staticStyle:{"font-size":"16px","margin-left":"5px",cursor:"pointer"}})])],1),r("el-form-item",{attrs:{label:"分发用户"}},[r("el-autocomplete",{attrs:{"popper-class":"user-autocomplete","fetch-suggestions":e.queryUserSearch,clearable:"","value-key":"userPhone",placeholder:"用户手机号(可选)"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.item;return[r("div",{staticClass:"phone"},[e._v(e._s(i.userPhone))]),r("span",{staticClass:"nick"},[e._v(e._s(i.userNick))])]}}]),model:{value:e.orderForm.phoneNum,callback:function(t){e.$set(e.orderForm,"phoneNum",t)},expression:"orderForm.phoneNum"}})],1),r("el-form-item",{attrs:{label:"接收手机"}},[r("el-input",{attrs:{clearable:"",placeholder:"接收预定信息手机号"},model:{value:e.orderForm.messagePhoneNum,callback:function(t){e.$set(e.orderForm,"messagePhoneNum",t)},expression:"orderForm.messagePhoneNum"}}),r("el-checkbox",{model:{value:e.orderForm.split,callback:function(t){e.$set(e.orderForm,"split",t)},expression:"orderForm.split"}},[e._v("当库存数量不足时，允许发放部分云机")])],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("span",{staticStyle:{float:"left","font-size":"14px","line-height":"32px"}},[e._v("现有河马币："),r("span",{staticStyle:{color:"#F56C6C"}},[e._v(e._s(e.hemaCoins))])]),r("span",{staticStyle:{"margin-left":"5px",float:"left","font-size":"14px","line-height":"32px"}},[e._v("支付价格："),r("span",{staticStyle:{color:"#F56C6C"}},[e._v(e._s(e.currentPrice))])]),r("el-button",{attrs:{type:"primary",loading:e.orderApplyLoding,size:"small"},on:{click:e.handleOrderSubmit}},[e._v(e._s(e.orderApplyLoding?"预定中":"确定预定")+" ")])],1)],1),r("div",{staticClass:"filter-container"},[r("el-button",{staticClass:"filter-item",attrs:{size:"small",type:"primary"},on:{click:e.handleOrderButtonClick}},[r("i",{staticClass:"el-icon-s-goods"}),e._v(" 预定云机 ")]),r("div",{staticStyle:{float:"right"}},[r("el-select",{staticClass:"filter-item",staticStyle:{width:"100px"},attrs:{placeholder:"预定状态",size:"small",clearable:""},on:{change:e.handleOrderListFilter},model:{value:e.orderListQuery.reserveOrderStatus,callback:function(t){e.$set(e.orderListQuery,"reserveOrderStatus",t)},expression:"orderListQuery.reserveOrderStatus"}},e._l(e.statusOrderListQueryOptions,(function(e){return r("el-option",{key:e.status,attrs:{label:e.option,value:e.status,size:"small"}})})),1),r("el-autocomplete",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{"popper-class":"user-autocomplete","fetch-suggestions":e.queryUserSearch,clearable:"","value-key":"userPhone",placeholder:"用户手机号",size:"small"},on:{clear:e.handleOrderListFilter,select:e.handleOrderListFilter},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.item;return[r("div",{staticClass:"phone"},[e._v(e._s(i.userPhone))]),r("span",{staticClass:"nick"},[e._v(e._s(i.userNick))])]}}]),model:{value:e.orderListQuery.userPhone,callback:function(t){e.$set(e.orderListQuery,"userPhone",t)},expression:"orderListQuery.userPhone"}}),r("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"预定单号",clearable:"",size:"small"},on:{clear:e.handleOrderListFilter},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleOrderListFilter(t)}},model:{value:e.orderListQuery.reserveOrderNo,callback:function(t){e.$set(e.orderListQuery,"reserveOrderNo",t)},expression:"orderListQuery.reserveOrderNo"}}),r("el-button",{staticClass:"filter-item",attrs:{size:"small"},on:{click:e.handleOrderListFilter}},[e._v(" 搜索 ")])],1)],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.orderListLoading,expression:"orderListLoading"}],staticStyle:{"max-width":"2000px"},attrs:{data:e.orderList,border:"","highlight-current-row":"",size:"small"}},[r("el-table-column",{attrs:{label:"ID",prop:"id",width:"65",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[r("span",[e._v(e._s(i.id))])]}}])}),r("el-table-column",{attrs:{label:"预定时间",width:"160",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[r("span",[e._v(e._s(i.orderDate))])]}}])}),r("el-table-column",{attrs:{label:"预定状态",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[r("span",[e._v(e._s(e.getPreStatus(i.reserveOrderStatus)))])]}}])}),r("el-table-column",{attrs:{label:"预定用户",width:"220",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[r("span",[e._v(e._s(e.getUserName(i.userPhone)))])]}}])}),r("el-table-column",{attrs:{label:"预定站点",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[r("span",[e._v(e._s(e.getSiteName(i.siteId)))])]}}])}),r("el-table-column",{attrs:{label:"预定内容","min-width":"245",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[r("span",[e._v(e._s(i.reserveOrderContent))])]}}])}),r("el-table-column",{attrs:{label:"预定数量",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[r("span",[e._v(e._s(i.deviceNum))])]}}])}),r("el-table-column",{attrs:{label:"预定时长",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[r("span",[e._v(e._s(i.reserveDays)+"天")])]}}])}),r("el-table-column",{attrs:{label:"支付金额",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[r("span",[e._v(e._s(i.realAmount))])]}}])}),r("el-table-column",{attrs:{label:"部分发放",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[r("span",[e._v(e._s(i.orderSplit?"支持":"不支持"))])]}}])}),r("el-table-column",{attrs:{label:"预定单号",width:"250",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[r("span",[e._v(e._s(i.reserveOrderSn))])]}}])})],1),r("pagination",{directives:[{name:"show",rawName:"v-show",value:e.orderListTotal>0,expression:"orderListTotal > 0"}],attrs:{total:e.orderListTotal,page:e.orderListQuery.page,limit:e.orderListQuery.pageSize},on:{"update:page":function(t){return e.$set(e.orderListQuery,"page",t)},"update:limit":function(t){return e.$set(e.orderListQuery,"pageSize",t)},pagination:e.getOrderList}})],1)},n=[],s=(r("99af"),r("4de4"),r("7db0"),r("c740"),r("4160"),r("caad"),r("c975"),r("a15b"),r("d81d"),r("13d5"),r("45fc"),r("a434"),r("b0c0"),r("ac1f"),r("2532"),r("1276"),r("159b"),r("2909")),o=r("5530"),a=r("2f62"),l=r("333d"),c=(r("4d44"),r("c24f")),u=r("f8b7"),d=[{status:1,option:"预定中"},{status:3,option:"预定成功"},{status:4,option:"已退款"},{status:5,option:"已关闭"},{status:0,option:"全部"}],p={name:"",components:{Pagination:l["a"]},data:function(){return{statusOrderListQueryOptions:d,orderListQuery:{reserveOrderStatus:1,reserveOrderNo:"",userPhone:"",page:1,pageSize:20},orderListTotal:0,orderListLoading:!1,orderList:[],userList:[],orderForm:{version:void 0,phoneNum:void 0,services:[],num:1,days:void 0,messagePhoneNum:void 0,split:!1,siteId:1},orderApplyLoding:!1,orderDialogVisible:!1,orderInfoList:[],siteBusinessServicePackageList:[],siteDeviceVersionInfoList:[],orderDaysOptions:[],orderDeviceVersionOptions:[],downloadLoading:!1}},computed:Object(o["a"])({},Object(a["b"])(["token","hemaCoins"]),{userPhoneMap:function(){var e={};return this.userList.forEach((function(t){e[t.userPhone]={phone:t.userPhone,name:t.userNick}})),e},currentPrice:function(){var e=this,t=this.orderForm,r=t.version,i=t.services,n=t.num,s=t.days,o=0,a=0,l=this.isMasterDeviceVersion(r);return r&&(o=this.siteDeviceVersionInfoList.find((function(e){return e.deviceVersionId===r&&e.productDays===s})).productPrice),i.length>0&&(a=i.reduce((function(t,r){return t+e.currentBusinessServicePackageList.find((function(e){return e.businessServiceId===r&&e.productDays===s})).productPrice}),0)),a=l?2*a:a,(o+a)*n},currentBusinessServicePackageList:function(){return this.siteBusinessServicePackageList?this.siteBusinessServicePackageList.reduce((function(e,t){return 1===t.nodeType?[].concat(Object(s["a"])(e),Object(s["a"])(t.dicBusinessServicePriceList)):[].concat(Object(s["a"])(e),[t])}),[]).filter((function(e){return 5!==e.businessServiceId&&16!==e.businessServiceId})):[]}}),mounted:function(){this.getSiteDeviceVersionInfoList(),this.getUserList(),this.getOrderList()},methods:{getUserName:function(e){if(""===e)return"";var t=this.userPhoneMap[e];return void 0===t?"未知用户":"".concat(t.phone,"(").concat(t.name,")")},getSiteName:function(e){switch(e){case 1:return"华东一站";case 2:return"华东二站";default:return"未知站点"}},getPreStatus:function(e){return this.statusOrderListQueryOptions.filter((function(t){return t.status===e})).map((function(e){return e.option})).join()},handleOrderSubmit:function(){var e=this,t=this.orderForm,r=t.siteId,i=t.version,n=t.phoneNum,s=t.services,o=t.num,a=t.days,l=t.messagePhoneNum,c=t.split,d=this.token;!n||/^1[3456789]\d{9}$/.test(n)?l?/^1[3456789]\d{9}$/.test(l)?this.orderApplyLoding||(this.orderApplyLoding=!0,Object(u["r"])({token:d,deviceVersionId:i,applyNum:o,businessServiceIdList:s,applyDays:a,userPhone:n,reservePhone:l,splitOrder:c?1:0,orderSiteId:r}).then((function(t){e.$message.success("预定成功！"),e.orderApplyLoding=!1,e.orderDialogVisible=!1,e.getOrderList()})).catch((function(){e.orderApplyLoding=!1}))):this.$message.warning("请填写正确的接受分发消息手机号"):this.$message.warning("请填写接受分发消息的手机号"):this.$message.warning("请填写正确的用户手机号")},handleOrderButtonClick:function(){this.orderDialogVisible=!0,this.siteSelectChange(this.orderForm.siteId),this.$store.dispatch("user/getManagerCoins")},handleOrderListFilter:function(){this.getOrderList()},getUserList:function(){var e=this,t=this.token;Object(c["c"])({token:t,page:1,pageSize:1e4}).then((function(t){var r=t.list;e.userList=r}))},getOrderList:function(){var e=this;this.orderListLoading=!0;var t=this.token;Object(u["n"])(Object(o["a"])({token:t},this.orderListQuery)).then((function(t){e.orderListLoading=!1,e.orderListTotal=t.total,e.orderList=t.list})).catch((function(){e.orderListLoading=!1}))},queryUserSearch:function(e,t){var r=this.userList,i=e?r.filter(this.createUserFilter(e)):r;t(i)},createUserFilter:function(e){return function(t){return 0===t.userPhone.toLowerCase().indexOf(e.toLowerCase())}},handleDownload:function(){},updateOrderDeviceForm:function(){this.updateOrderDeviceVersionOptions(),this.updateOrderDaysOptions()},updateOrderDeviceVersionOptions:function(){var e,t=this.siteDeviceVersionInfoList,r=t.reduce((function(e,t){return e.some((function(e){return e.value===t.deviceVersionId}))?Object(s["a"])(e):[].concat(Object(s["a"])(e),[{label:t.deviceVersionName,value:t.deviceVersionId}])}),[]),i=this.orderForm.version;i&&r.find((function(e){return e.value===i}))||(this.orderForm.version=null===(e=r[0])||void 0===e?void 0:e.value);this.orderDeviceVersionOptions=Object(s["a"])(r)},updateOrderDaysOptions:function(){var e,t=this.orderForm.version;t||(t=null===(e=this.siteDeviceVersionInfoList[0])||void 0===e?void 0:e.deviceVersionId);var r,i=this.siteDeviceVersionInfoList.filter((function(e){return e.deviceVersionId===t})).map((function(e){return{label:"".concat(e.productDays,"天").concat(e.productPrice,"元"),value:e.productDays}})),n=this.orderForm.days;n&&i.find((function(e){return e.value===n}))||(this.orderForm.days=null===(r=i[0])||void 0===r?void 0:r.value);this.orderDaysOptions=Object(s["a"])(i)},getSiteDeviceVersionInfoList:function(){var e=this;Object(u["i"])({siteId:this.orderForm.siteId}).then((function(t){e.siteDeviceVersionInfoList=t.data.dicDeviceVersionInfoList.filter((function(e){return e.isReserve})),e.siteBusinessServicePackageList=t.data.dicBusinessServicePackageList}))},siteSelectChange:function(e){var t=this;Object(u["i"])({siteId:e}).then((function(e){t.siteDeviceVersionInfoList=e.data.dicDeviceVersionInfoList.filter((function(e){return e.isReserve})),t.siteBusinessServicePackageList=e.data.dicBusinessServicePackageList,t.updateOrderDeviceForm()}))},businessServiceDisable:function(e){var t=this.orderForm.services;return!(2!==e||t.includes(1)||t.includes(8)||t.includes(9))||(4===e&&!t.includes(3)||(!(1!==e||!t.includes(8)&&!t.includes(9))||(!(8!==e||!t.includes(1)&&!t.includes(9))||!(9!==e||!t.includes(1)&&!t.includes(8)))))},isMasterDeviceVersion:function(e){var t;return null===(t=this.siteDeviceVersionInfoList.find((function(t){return t.deviceVersionId===e})))||void 0===t?void 0:t.isMasterSlave},getServicesOptions:function(e,t){var r=this,i=e||30,n=[{label:"IP代理",children:[]},{label:"设备大师",children:[]}];return this.currentBusinessServicePackageList.map((function(e){var s=e.businessServiceId,o=r.businessServiceDisable(s),a=t?2*e.productPrice:e.productPrice;0!==e.productPrice&&e.productDays===i&&(1===s||2===s||8===s||9===s?n[0].children.push({value:s,label:e.businessServiceName+"("+a+"元)",disabled:o}):3===s||4===s?n[1].children.push({value:s,label:e.businessServiceName+"("+a+"元)",disabled:o}):n.push({label:e.businessServiceName,children:[{value:s,label:e.businessServiceName+"("+a+"元)",disabled:o}]}))})),n},servicesChange:function(){var e=this.orderForm.services,t=e.findIndex((function(e){return 2===e}));t>-1&&(e.includes(1)||e.includes(8)||e.includes(9)||e.splice(t,1));var r=e.findIndex((function(e){return 4===e}));r>-1&&(e.includes(3)||e.splice(r,1))}}},f=p,v=(r("dc93"),r("b3de"),r("2877")),m=Object(v["a"])(f,i,n,!1,null,"b7f31146",null);t["default"]=m.exports},b3de:function(e,t,r){"use strict";var i=r("f93e"),n=r.n(i);n.a},d887:function(e,t,r){"use strict";var i=r("1989"),n=r.n(i);n.a},dc93:function(e,t,r){"use strict";var i=r("57ce"),n=r.n(i);n.a},f93e:function(e,t,r){}}]);